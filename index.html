<!DOCTYPE <!DOCTYPE html>
<html>
<head>
	<meta charset='utf-8'>
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<link rel="stylesheet" type="text/css" href=./static/css/bootstrap.css>
    <link rel="stylesheet" type="text/css" media="screen" href=./static/css/style.css>
    <style>
      #map {
        height: 100%;
      }
    </style>

    <!-- insert google analytics here -->
	<title>ISS Tracker</title>
</head>
<body>
	<nav class="container">
		<!-- collapsed navbar for small screen -->
		<nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
			<div class="container-fluid" id="navfluid">
				<div class="navbar-header">
					<button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navigaitonbar"></button>
					<span class="sr-only">Toggle navigation</span>
					<span class="icon-bar"></span>
             		<span class="icon-bar"></span>
             		<span class="icon-bar"></span>
				</div>
			</div>

			<!-- Full navbar -->
			<div class="navbar-collapse collapse" id="navigationbar">
	          <ul class="nav navbar-nav pull-left">
	            <li><a href="https://margaretsy.com">Home</a></li>
	          </ul>
	      	</div>
		</nav>

		<!-- Main -->
		<div class="row">
			<div class="col-md-6 col-md-offset-3">
				<h1>Track the ISS</h1>
				<br>
				<p>Well, once this is implemented, anyway. Please don't touch the map, I think it breaks things ⊙~⊙</p>
				<button type="button" class="btn btn-primary btn-lg" id="updateMap">Update</button>
				<br>

				<div id="map"></div>
			</div>
		</div>
	</nav>

	<!-- <div id="map"></div> -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
	<script type="text/javascript" src=./static/js/bootstrap.min.js></script>
	<script type="text/javascript" src=./static/js/app.js></script>
	<script>


var openNotifyEndpoint = 'http://api.open-notify.org/iss-now.json?callback=?'
function getIssPosition() {
	$.getJSON(openNotifyEndpoint, function(data) {
		initMap(data.iss_position.latitude, data.iss_position.longitude);
	})
}

function setIssPosition() {
	$.getJSON(openNotifyEndpoint, function(data) {
		var issPoint = {lat: data.iss_position.latitude, lng: data.iss_position.longitude};		
		console.log("updating ISS position to " + issPoint.lat + ", " + issPoint.lng)
		map.setCenter(issPoint);
		marker.setPosition(issPoint);
	})
}


var map;
var marker;
function initMap(latitude, longitude) {
  console.log(latitude, longitude)
  var issPoint = {lat: latitude, lng: longitude};
  map = new google.maps.Map(document.getElementById('map'), {
    center: issPoint,
    zoom: 4,
    scrollwheel: false
  });
  // Set marker position.
  marker = new google.maps.Marker({
    map: map,
    position: issPoint,
    title: 'ISS is here!'
  });

$("#updateMap").click(setIssPosition)

}

    </script>
    <!-- Key is set to only accept requests from this site. -->
	 <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyC2lYc_Eb262K1WpruhiZU18Db2Dapm21o&callback=getIssPosition" async defer></script>



</body>
</html>